<div class="container mt-5" data-controller="slide-transition" data-slide-transition-initial-load-value="true">

  <!-- Slide Card Container -->
  <div class="slide-card" data-slide-transition-target="slideCard">

    <!-- Welcome Screen -->
    <div class="welcome-card">
      <div class="welcome-card-header">
        <%= image_tag 'ffresq-logo-optimized-min.png', class: 'welcome-logo', alt: 'fur&feather resQ - Your Animal Rescue Assistant' %>
        <p class="welcome-subtitle">Your Animal Rescue Assistant</p>
      </div>
      <button type="button" class="welcome-cta" data-action="click->slide-transition#transitionToForm">
        <span class="cta-text">How can I help?</span>
        <span class="cta-arrow">â†’</span>
      </button>
    </div>

    <!-- Form Screen -->
    <div class="form-card">
      <!-- Mobile Form Header -->
      <div class="mobile-form-header">
        <%= image_tag 'logo-form-v2-min.png', class: 'form-logo', alt: 'i am here to help' %>
        <h2 class="form-headline">Tell me about the animal</h2>
      </div>

      <!-- Main intake form -->
      <%= simple_form_for (@intake || Intake.new),
                          url: intakes_path,
                          method: :post,
                          data: {
                            action: "submit->slide-transition#submitWithValidation",
                            controller: "mobile-form"
                          },
                          html: { multipart: true, class: "mobile-form", id: "intakeForm" } do |f| %>

        <!-- --- Species field --- -->
        <%= f.input :species,
                    label: "Species",
                    placeholder: "e.g., Blackbird, Hedgehog, Pigeon",
                    required: true,
                    input_html: {
                      class: "form-control",
                      autocomplete: "off",
                      autocapitalize: "words"
                    } %>

        <!-- --- Description field --- -->
        <%= f.input :description,
                    label: "Description",
                    as: :text,
                    required: true,
                    input_html: {
                      placeholder: "What happened? Describe the situation...",
                      class: "form-control",
                      rows: 4,
                      autocomplete: "off"
                    } %>

        <!-- --- Photo upload - Mobile Camera Style --- -->
        <div class="form-group" data-controller="photo-upload">
          <label>Photo (optional)</label>
          <div class="mobile-photo-upload">
            <%= f.input :photo,
                        as: :file,
                        label: false,
                        wrapper: false,
                        input_html: {
                          accept: "image/*",
                          capture: "environment",
                          class: "d-none",
                          id: "photoInput",
                          data: {
                            photo_upload_target: "input",
                            action: "change->photo-upload#handleFileSelect"
                          }
                        } %>

            <div class="upload-area" data-action="click->photo-upload#clearFile" onclick="document.getElementById('photoInput').click()">
              <div class="upload-icon">ðŸ“·</div>
              <div class="upload-text">Tap to take photo</div>
              <div class="upload-hint">or choose from gallery</div>
            </div>

            <div class="file-preview" data-photo-upload-target="preview">
              <div class="preview-icon"><i class="fa-regular fa-image"></i></div>
              <div class="preview-info">
                <div class="file-name" data-photo-upload-target="fileName"></div>
                <div class="file-size" data-photo-upload-target="fileSize"></div>
              </div>
              <button type="button" class="remove-file" data-action="click->photo-upload#clearFile" aria-label="Remove photo">Ã—</button>
            </div>
          </div>
        </div>

        <!-- --- Submit button --- -->
        <button type="submit" class="mobile-submit" id="submitBtn">
          <span class="submit-text">
            <i class="fa-solid fa-comments"></i>
            Get instant help
          </span>
        </button>

      <% end %>
    </div>

  </div>
</div>
